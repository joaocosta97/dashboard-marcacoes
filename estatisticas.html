<h1>ðŸ“Š EstatÃ­sticas Gerais</h1>

<div class="stat">Total de marcaÃ§Ãµes: <strong id="total">-</strong></div>
<div class="stat">Pendentes: <strong id="pendentes">-</strong></div>
<div class="stat">Tratadas: <strong id="tratados">-</strong></div>
<div class="stat">Canceladas: <strong id="cancelados">-</strong></div>
<div class="stat">Exames: <strong id="exames">-</strong></div>
<div class="stat">Consultas: <strong id="consultas">-</strong></div>

<script type="module">
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCFUE-h0mH-NTfDrVTalWpj2M3tREX2HoA",
    authDomain: "chatbot-elvira.firebaseapp.com",
    projectId: "chatbot-elvira",
    storageBucket: "chatbot-elvira.firebasestorage.app",
    messagingSenderId: "794247687628",
    appId: "1:794247687628:web:e13e114370fe2e278f8169"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  async function carregarEstatisticas() {
    const snapshot = await getDocs(collection(db, "marcacoes"));
    const total = snapshot.size;
    let pendentes = 0, tratados = 0, cancelados = 0, exames = 0, consultas = 0;

    snapshot.forEach(doc => {
      const m = doc.data();
      if (m.estado === 'pendente') pendentes++;
      else if (m.estado === 'tratado') tratados++;
      else if (m.estado === 'cancelado') cancelados++;

      if (m.tipo === 'exame') exames++;
      if (m.tipo === 'consulta') consultas++;
    });

    document.getElementById('total').textContent = total;
    document.getElementById('pendentes').textContent = pendentes;
    document.getElementById('tratados').textContent = tratados;
    document.getElementById('cancelados').textContent = cancelados;
    document.getElementById('exames').textContent = exames;
    document.getElementById('consultas').textContent = consultas;
  }

  carregarEstatisticas();
</script>
